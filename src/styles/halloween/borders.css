/**
 * Halloween Border Effects
 * 
 * This file contains border effect styles for the Halloween theme enrichment.
 * Effects include dripping borders, ethereal glows, and spectral outlines.
 * All effects include prefers-reduced-motion fallbacks.
 * 
 * Effects:
 * 1. dripping-border - Subtle dripping effect on card/panel borders
 * 2. ethereal-glow - Animated purple glow for panels and sidebars
 * 3. spectral-outline - Animated outline for selected nodes
 * 4. candle-flicker-focus - Flickering glow on input focus
 * 
 * **Feature: halloween-theme-enrichment**
 * **Validates: Requirements 1.1, 1.2, 1.3, 1.4, 1.5**
 */

/* ==========================================================================
   1. Dripping Border Effect
   Subtle dripping effect using CSS pseudo-elements and clip-path
   Applicable to: cards, panels, nodes
   Requirements: 1.1, 1.4, 1.5
   ========================================================================== */

@keyframes drippingBorder {
  0%, 100% {
    clip-path: polygon(
      0% 0%, 100% 0%, 100% 100%,
      95% 100%, 95% 102%, 90% 100%,
      85% 100%, 85% 104%, 80% 100%,
      75% 100%, 75% 101%, 70% 100%,
      65% 100%, 65% 103%, 60% 100%,
      55% 100%, 55% 102%, 50% 100%,
      45% 100%, 45% 105%, 40% 100%,
      35% 100%, 35% 101%, 30% 100%,
      25% 100%, 25% 103%, 20% 100%,
      15% 100%, 15% 102%, 10% 100%,
      5% 100%, 5% 104%, 0% 100%
    );
  }
  50% {
    clip-path: polygon(
      0% 0%, 100% 0%, 100% 100%,
      95% 100%, 95% 104%, 90% 100%,
      85% 100%, 85% 102%, 80% 100%,
      75% 100%, 75% 105%, 70% 100%,
      65% 100%, 65% 101%, 60% 100%,
      55% 100%, 55% 103%, 50% 100%,
      45% 100%, 45% 102%, 40% 100%,
      35% 100%, 35% 104%, 30% 100%,
      25% 100%, 25% 101%, 20% 100%,
      15% 100%, 15% 105%, 10% 100%,
      5% 100%, 5% 102%, 0% 100%
    );
  }
}

.halloween .halloween-drip-border {
  position: relative;
  overflow: visible;
}

.halloween .halloween-drip-border::after {
  content: '';
  position: absolute;
  bottom: -6px;
  left: 0;
  right: 0;
  height: 10px;
  background: linear-gradient(
    180deg,
    hsl(270 40% 35%) 0%,
    hsl(270 50% 25%) 100%
  );
  pointer-events: none;
  z-index: 1;
  animation: drippingBorder 4s ease-in-out infinite;
  border-radius: 0 0 4px 4px;
}

/* ==========================================================================
   2. Ethereal Glow Effect
   Animated purple glow for panels and sidebars
   Applicable to: panels, sidebars, modals
   Requirements: 1.2, 1.4, 1.5
   ========================================================================== */

@keyframes etherealGlow {
  0%, 100% {
    box-shadow: 
      0 0 15px 2px hsl(270 70% 60% / 0.2),
      0 0 30px 5px hsl(270 70% 60% / 0.1),
      inset 0 0 10px hsl(270 70% 60% / 0.05);
  }
  50% {
    box-shadow: 
      0 0 25px 5px hsl(270 70% 60% / 0.35),
      0 0 50px 10px hsl(270 70% 60% / 0.15),
      inset 0 0 15px hsl(270 70% 60% / 0.08);
  }
}

.halloween .halloween-ethereal-glow {
  position: relative;
  animation: etherealGlow 3s ease-in-out infinite;
}

.halloween .halloween-ethereal-glow::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: inherit;
  background: linear-gradient(
    135deg,
    hsl(270 70% 60% / 0.1) 0%,
    transparent 50%,
    hsl(270 70% 60% / 0.1) 100%
  );
  pointer-events: none;
  z-index: -1;
}

/* ==========================================================================
   3. Spectral Outline Effect
   Animated outline for selected nodes and cards
   Applicable to: nodes, cards
   Requirements: 1.2, 1.4, 1.5
   ========================================================================== */

@keyframes spectralOutline {
  0%, 100% {
    outline-color: hsl(270 70% 60% / 0.5);
    outline-offset: 2px;
  }
  50% {
    outline-color: hsl(270 70% 60% / 0.8);
    outline-offset: 4px;
  }
}

@keyframes spectralOutlineGlow {
  0%, 100% {
    box-shadow: 
      0 0 0 2px hsl(270 70% 60% / 0.3),
      0 0 10px 2px hsl(270 70% 60% / 0.2);
  }
  50% {
    box-shadow: 
      0 0 0 3px hsl(270 70% 60% / 0.5),
      0 0 20px 4px hsl(270 70% 60% / 0.3);
  }
}

.halloween .halloween-spectral-outline {
  outline: 2px solid hsl(270 70% 60% / 0.5);
  outline-offset: 2px;
  animation: spectralOutline 2s ease-in-out infinite,
             spectralOutlineGlow 2s ease-in-out infinite;
}

/* ==========================================================================
   4. Candle Flicker Focus Effect
   Flickering glow effect for input fields on focus
   Applicable to: inputs, textareas
   Requirements: 1.3, 1.4, 1.5
   ========================================================================== */

@keyframes candleFlickerFocus {
  0%, 100% {
    box-shadow: 
      0 0 8px 2px hsl(270 70% 60% / 0.3),
      0 0 16px 4px hsl(270 70% 60% / 0.15),
      0 0 2px 1px hsl(30 90% 50% / 0.2);
  }
  25% {
    box-shadow: 
      0 0 6px 1px hsl(270 70% 60% / 0.25),
      0 0 12px 3px hsl(270 70% 60% / 0.1),
      0 0 3px 1px hsl(30 90% 50% / 0.15);
  }
  50% {
    box-shadow: 
      0 0 12px 3px hsl(270 70% 60% / 0.4),
      0 0 24px 6px hsl(270 70% 60% / 0.2),
      0 0 4px 2px hsl(30 90% 50% / 0.25);
  }
  75% {
    box-shadow: 
      0 0 5px 1px hsl(270 70% 60% / 0.2),
      0 0 10px 2px hsl(270 70% 60% / 0.1),
      0 0 2px 1px hsl(30 90% 50% / 0.1);
  }
}

.halloween .halloween-candle-flicker-focus:focus,
.halloween .halloween-candle-flicker-focus:focus-within {
  animation: candleFlickerFocus 2s ease-in-out infinite;
  border-color: hsl(270 70% 60% / 0.6);
}

/* ==========================================================================
   Reduced Motion Fallbacks
   Static alternatives for users who prefer reduced motion
   Requirements: 1.5
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  .halloween .halloween-drip-border::after {
    animation: none;
    /* Static drip appearance */
    clip-path: polygon(
      0% 0%, 100% 0%, 100% 100%,
      95% 100%, 95% 102%, 90% 100%,
      85% 100%, 85% 103%, 80% 100%,
      75% 100%, 75% 101%, 70% 100%,
      65% 100%, 65% 102%, 60% 100%,
      55% 100%, 55% 101%, 50% 100%,
      45% 100%, 45% 103%, 40% 100%,
      35% 100%, 35% 101%, 30% 100%,
      25% 100%, 25% 102%, 20% 100%,
      15% 100%, 15% 101%, 10% 100%,
      5% 100%, 5% 102%, 0% 100%
    );
  }

  .halloween .halloween-ethereal-glow {
    animation: none;
    box-shadow: 
      0 0 20px 3px hsl(270 70% 60% / 0.25),
      0 0 40px 8px hsl(270 70% 60% / 0.12),
      inset 0 0 12px hsl(270 70% 60% / 0.06);
  }

  .halloween .halloween-spectral-outline {
    animation: none;
    outline: 2px solid hsl(270 70% 60% / 0.6);
    outline-offset: 3px;
    box-shadow: 
      0 0 0 2px hsl(270 70% 60% / 0.4),
      0 0 15px 3px hsl(270 70% 60% / 0.25);
  }

  .halloween .halloween-candle-flicker-focus:focus,
  .halloween .halloween-candle-flicker-focus:focus-within {
    animation: none;
    box-shadow: 
      0 0 10px 2px hsl(270 70% 60% / 0.35),
      0 0 20px 5px hsl(270 70% 60% / 0.18);
    border-color: hsl(270 70% 60% / 0.6);
  }
}
